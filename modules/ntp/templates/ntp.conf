##
## THIS FILE IS UNDER PUPPET CONTROL. DON'T EDIT IT HERE.
## USE: git clone git+ssh://$USER@puppet.debian.org/srv/puppet.debian.org/git/dsa-puppet.git
##

driftfile /var/lib/ntp/ntp.drift
statsdir /var/log/ntpstats/

statistics loopstats peerstats clockstats
filegen loopstats file loopstats type day enable
filegen peerstats file peerstats type day enable
filegen clockstats file clockstats type day enable

crypto randfile /dev/urandom
keysdir /etc/ntp.keys.d

<% if nodeinfo['timeserver'] -%>
server 0.debian.pool.ntp.org iburst dynamic
server 1.debian.pool.ntp.org iburst dynamic
server 2.debian.pool.ntp.org iburst dynamic
server 3.debian.pool.ntp.org iburst dynamic
<%   if fqdn == "orff.debian.org" -%>
server ntp.grnet.gr iburst
<%   end -%>
<% elsif fqdn == "ancina.debian.org" -%>
server ntp.ugent.be iburst dynamic
<% elsif nodeinfo['misc']['natted'] -%>
# autokey doesn't work behind nat
server merikanto.debian.org iburst
server orff.debian.org      iburst
server ravel.debian.org     iburst
server busoni.debian.org    iburst
<% else -%>
server merikanto.debian.org iburst autokey
server orff.debian.org      iburst autokey
server ravel.debian.org     iburst autokey
server busoni.debian.org    iburst autokey
restrict merikanto.debian.org notrust nomodify notrap ntpport
restrict orff.debian.org      notrust nomodify notrap ntpport
restrict ravel.debian.org     notrust nomodify notrap ntpport
restrict busoni.debian.org    notrust nomodify notrap ntpport
<% end -%>

restrict -4 default kod notrap nomodify nopeer noquery
restrict -6 default kod notrap nomodify nopeer noquery

restrict 127.0.0.1
restrict ::1

# vim:set et:
# vim:set sts=4 ts=4:
# vim:set shiftwidth=4:
